# coding theory
このアプリケーションのコードを書く際に留意する点

Elixirはご存知の通り卍動的型付け言語卍であり、今回の開発のスローガン(?)は「いわゆる'動的型付け言語の辛み'を上手く誤魔化す」である

~~動的型付けが辛いと思うならそもそも静的方付け言語で開発すれば良いのではって言った人は後で職員室まで~~

## behaviorをうまく扱う

- behaviorはinterfaceのようなもの
- うまく扱うことでテスト時にモックに差し替えるなどのinterfaceと同様のメリットを得られる
  - mockを扱うには[mox](https://github.com/dashbitco/mox)が便利そう
- repositoryや各種APIを扱うモジュールに関してはbehaviorを挟むことにする

## 基本的にpublicか否かを問わず全ての関数にspec(関数の型情報)を記載する

- dialyzerによる静的型チェックを導入したい
- behaviorにおけるspecと合っているかを確認しやすい
- 例えば訳わからんタプルに情報を詰め込んで返り値を返すのではなく、共通のタプルを意識的に扱うことができる(specの記述のためにtypeなどで定義する必要が出てくるため
  - 帰り値として返すタプルなどをうまく独自型に落としておき、関数で返すタプルをある程度統一することでパイプライン演算子で扱いやすくなる
    - そもそも一つのパイプライン演算子の流れの中で扱う情報は統一すべきと言う持論がある
    - 途中で流れる情報が変わるときは別の関数に切り出すべきというこれも持論がある(関数の切り分けに関しては後述)

## 関数の切り分けは意識的に細かくする

- dialyzerによる静的型チェックの恩恵を最大限に受けるために関数を細々切り分けたい
  - 関数の引数と返り値のチェックしかできないため
  - 細々関数を行ったりきたりすることで型の齟齬を発見しやすくしたい
- 関数に切り出すまでもなさそうな処理も関数に細々わけるように意識する
